{"version":3,"file":"menu-directive.js","sourceRoot":"","sources":["../../../src/lib/menu/menu-directive.ts"],"names":[],"mappings":"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","sourcesContent":["// TODO(kara): prevent-close functionality\n\nimport {\n  AfterContentInit,\n  Attribute,\n  Component,\n  ContentChildren,\n  EventEmitter,\n  Input,\n  OnDestroy,\n  Output,\n  QueryList,\n  TemplateRef,\n  ViewChild,\n  ViewEncapsulation,\n} from '@angular/core';\nimport {MenuPositionX, MenuPositionY} from './menu-positions';\nimport {VdlMenuInvalidPositionX, VdlMenuInvalidPositionY} from './menu-errors';\nimport {VdlMenuItem} from './menu-item';\nimport {FocusKeyManager} from '../core/a11y/focus-key-manager';\nimport {VdlMenuPanel} from './menu-panel';\nimport {Subscription} from 'rxjs/Subscription';\nimport {transformMenu, fadeInItems} from './menu-animations';\n\n@Component({\n  moduleId: module.id,\n  selector: 'vdl-menu',\n  host: {'role': 'menu'},\n  templateUrl: 'menu.html',\n  styleUrls: ['menu.css'],\n  encapsulation: ViewEncapsulation.None,\n  animations: [\n    transformMenu,\n    fadeInItems\n  ],\n  exportAs: 'vdlMenu'\n})\nexport class VdlMenu implements AfterContentInit, VdlMenuPanel, OnDestroy {\n  private _keyManager: FocusKeyManager;\n\n  /** Subscription to tab events on the menu panel */\n  private _tabSubscription: Subscription;\n\n  /** Config object to be passed into the menu's ngClass */\n  _classList: any = {};\n\n  /** Position of the menu in the X axis. */\n  positionX: MenuPositionX = 'after';\n\n  /** Position of the menu in the Y axis. */\n  positionY: MenuPositionY = 'below';\n\n  @ViewChild(TemplateRef) templateRef: TemplateRef<any>;\n  @ContentChildren(VdlMenuItem) items: QueryList<VdlMenuItem>;\n  @Input() overlapTrigger = true;\n\n  constructor(@Attribute('x-position') posX: MenuPositionX,\n              @Attribute('y-position') posY: MenuPositionY) {\n    if (posX) { this._setPositionX(posX); }\n    if (posY) { this._setPositionY(posY); }\n    this.setPositionClasses(this.positionX, this.positionY);\n  }\n\n  ngAfterContentInit() {\n    this._keyManager = new FocusKeyManager(this.items).withWrap();\n    this._tabSubscription = this._keyManager.tabOut.subscribe(() => {\n      this._emitCloseEvent();\n    });\n  }\n\n  ngOnDestroy() {\n    this._tabSubscription.unsubscribe();\n  }\n\n  /**\n   * This method takes classes set on the host vdl-menu element and applies them on the\n   * menu template that displays in the overlay container.  Otherwise, it's difficult\n   * to style the containing menu from outside the component.\n   * @param classes list of class names\n   */\n  @Input('class')\n  set classList(classes: string) {\n    this._classList = classes.split(' ').reduce((obj: any, className: string) => {\n      obj[className] = true;\n      return obj;\n    }, {});\n    this.setPositionClasses(this.positionX, this.positionY);\n  }\n\n  /** Event emitted when the menu is closed. */\n  @Output() close = new EventEmitter<void>();\n\n  /**\n   * Focus the first item in the menu. This method is used by the menu trigger\n   * to focus the first item when the menu is opened by the ENTER key.\n   */\n  focusFirstItem() {\n    this._keyManager.setFirstItemActive();\n  }\n\n  /**\n   * This emits a close event to which the trigger is subscribed. When emitted, the\n   * trigger will close the menu.\n   */\n  _emitCloseEvent(): void {\n    this.close.emit();\n  }\n\n  private _setPositionX(pos: MenuPositionX): void {\n    if ( pos !== 'before' && pos !== 'after') {\n      throw new VdlMenuInvalidPositionX();\n    }\n    this.positionX = pos;\n  }\n\n  private _setPositionY(pos: MenuPositionY): void {\n    if ( pos !== 'above' && pos !== 'below') {\n      throw new VdlMenuInvalidPositionY();\n    }\n    this.positionY = pos;\n  }\n\n  /**\n   * It's necessary to set position-based classes to ensure the menu panel animation\n   * folds out from the correct direction.\n   */\n  setPositionClasses(posX: MenuPositionX, posY: MenuPositionY): void {\n    this._classList['vdl-menu-before'] = posX == 'before';\n    this._classList['vdl-menu-after'] = posX == 'after';\n    this._classList['vdl-menu-above'] = posY == 'above';\n    this._classList['vdl-menu-below'] = posY == 'below';\n  }\n\n}\n"]}